---
import { getCollection } from "astro:content";
const allReviews = await getCollection("reviews");
import { Picture } from "astro:assets";

import Hook from "~/assets/icon_hook.svg";
import { formatDate } from "../utils";
import MonaImage from '~/assets/images/reviews/mona.jpg';
import MonaPerson from '~/assets/images/reviews/mona_person.jpg';
import MichelPerson from '~/assets/images/reviews/michel_person.jpg';
import LaurencePerson from '~/assets/images/reviews/laurence_person.jpg';
import SebastienPerson from '~/assets/images/reviews/sebastien_person.jpg';
import LaurenceImage from '~/assets/images/reviews/laurence.jpg';
import MichelImage from '~/assets/images/reviews/Michel.jpg';
import SebastienImage from '~/assets/images/reviews/sebastien.jpg';
---

<div class="swiper w-full mt-8 bg-white rounded-lg">
	<div class="swiper-wrapper h-auto w-auto ">
		{
			allReviews.map((review, index) => {
        // Sélectionner l'image correspondante en fonction de l'index
        let mealImage;
        let personImage
        switch (index) {
          case 0:
            mealImage = MonaImage;
            personImage=MonaPerson
            break;
          case 1:
            mealImage = LaurenceImage;
            personImage=LaurencePerson
            break;
          case 2:
            mealImage = MichelImage;
            personImage=MichelPerson;
            break;
          case 3:
            mealImage = SebastienImage;
            personImage=SebastienPerson;
            break;
          default:
            mealImage = MonaImage; // Valeur par défaut si besoin
            personImage=SebastienPerson;
        }

        return (
		<div class="swiper-slide cursor-pointer select-none">
    <div class="flex items-center justify-between mx-2 sm:mx-4">
        <div class="flex justify-center items-center gap-3 sm:gap-4">
            <Picture
                class="w-12 h-12 sm:w-14 sm:h-14 object-cover rounded-full"
                src={personImage}
                alt="Repas image"
            />
            <div>
                <h6 class="font-semibold text-base sm:text-lg">{review.data.author}</h6>
                <h8 class="text-gray-500 text-xs sm:text-sm">{formatDate(review.data.pubDate)}</h8>
            </div>
        </div>

        <Picture
            class="w-5 h-5 sm:w-6 sm:h-6 mx-auto"
            src={Hook}
            alt="A Hook"
        />
    </div>

    <div class="flex items-center m-2 sm:m-4">
        <Picture
            class="w-24 h-24 sm:w-32 sm:h-32 object-cover rounded-lg ml-2 sm:ml-4"
            src={mealImage}
            alt="Repas image"
        />

        <div class="flex-1 px-4 sm:px-6 lg:px-8">
            <blockquote class="border-none">
                <p class="text-sm sm:text-base font-medium text-balance">{review.data.review}</p>
            </blockquote>
        </div>
    </div>
</div>

        );
      })
		}
	</div>
	<div class="swiper-pagination"></div>
</div>

<script>
	import Swiper from "swiper";
	import { Pagination, Autoplay } from "swiper/modules";
	import "swiper/css";
	import "swiper/css/pagination";

	document.addEventListener("astro:page-load", () => {
		const swiper = document.querySelector(".swiper") as HTMLElement;
		new Swiper(swiper, {
			modules: [Pagination, Autoplay],
			loop: true,
			slidesPerView: 1,
			spaceBetween: 32,
			autoplay: {
				delay: 2500,
			},
			pagination: {
				el: ".swiper-pagination",
			},
		});
	});
</script>
