---

---

<form action="#" id="reservationForm">
	<div class="flex flex-col gap-8 mx-auto max-w-md">
		<div>
			<label for="name">Prénom</label>
			<div class="mt-2">
				<input type="text" name="name" id="name" required />
			</div>
		</div>

		<div>
			<label for="email">Email</label>
			<div class="mt-2 grid grid-cols-1">
				<input type="email" name="email" id="email" required />
			</div>
		</div>

		<div>
			<label for="phone">Téléphone</label>
			<div class="mt-2">
				<input type="text" name="phone" id="phone" required />
			</div>
			<small class="italic text-gray-500">Un SMS sera envoyé pour confirmer votre réservation</small>
		</div>

		<div>
			<label for="date">Date & Time</label>
			<div class="mt-2">
				<input type="datetime-local" name="date" id="date" required />
			</div>
			<small class="italic text-gray-500"
				>Nous ne pouvons garantir la disponibilité à l'heure et à la date choisies.</small
			>
		</div>

		<div>
			<label for="message">Notes</label>
			<div class="mt-2">
				<textarea
					name="message"
					id="message"
					rows="4"
					required
					placeholder="Faites-nous savoir si vous avez des allergies ou si vous avez une table spécifique en tête"></textarea>
			</div>
		</div>

		<div>
			<button type="submit" class="button button-green group !px-8">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 24 24"
					stroke-width="1.5"
					stroke="currentColor"
					class="size-5 -rotate-45 -mt-1 inline-block mr-1 group-hover:rotate-0 transition duration-300"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"
					></path>
				</svg>
				Réservez
			</button>
		</div>
	</div>

	<div id="formStatus" class="hidden">
		<div class="success-message hidden">
			Reservation successful!
		</div>
		<div class="error-message hidden">
			Something went wrong. Please try again.
		</div>
	</div>
	
</form>


<script>
document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('reservationForm') as HTMLFormElement;

    const formStatus = document.getElementById('formStatus') as HTMLElement;
    const successMessage = document.querySelector('.success-message') as HTMLElement;
    const errorMessage = document.querySelector('.error-message') as HTMLElement;

    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = new FormData(form);
        const data = {
            name: formData.get('name'),
            email: formData.get('email'),
            phone: formData.get('phone'),
            date_time: formData.get('date'), // Date format: YYYY-MM-DDTHH:mm
            message: formData.get('message') || ''
        };

        try {
            const response = await fetch('http://localhost:8000/api/reservations/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });

            formStatus.classList.remove('hidden');

            if (response.ok) {
                // Réservation réussie
				console.log(response)
                successMessage.classList.remove('hidden');
                errorMessage.classList.add('hidden');
                form.reset();
            } else {
                // Erreur
                errorMessage.classList.remove('hidden');
                successMessage.classList.add('hidden');
                console.error('Erreur lors de la réservation:', await response.json());
            }
        } catch (error) {
            formStatus.classList.remove('hidden');
            errorMessage.classList.remove('hidden');
            successMessage.classList.add('hidden');
            console.error('Erreur:', error);
        }
    });
});
